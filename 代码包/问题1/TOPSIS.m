%%封装一个Pos函数（单独的m文件）
%function [posit_x] = Pos(x,type,i)
%    if type == 1  %极小型
%        posit_x = mintomax(x);  %调用mintomax函数来正向化
%    elseif type == 2  %中间型
%        best = input('请输入最佳的那一个值： ');
%        posit_x = mintomax(x,best);
%    elseif type == 3  %区间型
%        posit_x = Inter2Max(x,a,b);
%    else
%        disp('无此类指标，请检查是否有问题：')
%    end
%end
%%封装一个mintomax函数（用于正向化）（单独的m文件）
%function [posit_x] = mintomax(x)
%    posit_x = max(x) - x;
%end
%%TOPSIS计算
clear;clc    %把EXCEL数据复制并将这个矩阵命名为X
LZC=[0.9677  0.0092  0.0021 0.0000 	0.0081 	0.0026 	0.0000 	0.0000 	0.0000 ;
0.9502 	0.0059 	0.0062 	0.0000 	0.0132 	0.0032 	0.0000 	0.0035 	0.0000 ;
0.9429 	0.0101 	0.0072 	0.0000 	0.0146 	0.0029 	0.0000 	0.0015 	0.0000 ;
0.9263 	0.0000 	0.0107 	0.0000 	0.0198 	0.0017 	0.0000 	0.0061 	0.0000 ;
0.9272 	0.0000 	0.0094 	0.0054 	0.0251 	0.0020 	0.0000 	0.0036 	0.0000 ;
0.9235 	0.0074 	0.0166 	0.0064 	0.0350 	0.0035 	0.0000 	0.0021 	0.0000 ;
0.8705 	0.0519 	0.0201 	0.0000 	0.0406 	0.0000 	0.0025 	0.0066 	0.0000 ;
0.7946 	0.0942 	0.0000 	0.0153 	0.0305 	0.0000 	0.0000 	0.0136 	0.0007 ;
0.7668 	0.0000 	0.0471 	0.0122 	0.0619 	0.0237 	0.0100 	0.0110 	0.0000 ;
0.6933 	0.0999 	0.0632 	0.0087 	0.0393 	0.0174 	0.0000 	0.0117 	0.0000 ;
0.6518 	0.1452 	0.0827 	0.0052 	0.0618 	0.0042 	0.0011 	0.0000 	0.0004 ;
0.5901 	0.1253 	0.0870 	0.0000 	0.0616 	0.0288 	0.0000 	0.0127 	0.0000 ;
0.6588 	0.0967 	0.0712 	0.0156 	0.0644 	0.0206 	0.0000 	0.0079 	0.0000 ;
0.6247 	0.1228 	0.0823 	0.0066 	0.0923 	0.0050 	0.0162 	0.0016 	0.0000 ;
0.6765 	0.0737 	0.0000 	0.0198 	0.1115 	0.0239 	0.0020 	0.0418 	0.0011 ;
0.6158 	0.1095 	0.0735 	0.0177 	0.0750 	0.0262 	0.0000 	0.0094 	0.0006 ;
0.6171 	0.1237 	0.0587 	0.0111 	0.0550 	0.0216 	0.0141 	0.0070 	0.0010 ;
0.5981 	0.0768 	0.0541 	0.0173 	0.1005 	0.0604 	0.0035 	0.0450 	0.0012 ];     %高钾玻璃
%LZC=[0.6366 0.0304 0.0078 	0.1366 	0.0000 ;0.5379 	0.0792 	0.0050 	0.1698 	0.0000 ;
%0.6128 0.0266 	0.0084 	0.1599 	0.0000 ;0.7551 	0.0000 	0.0064 	0.1616 	0.0013 ;
%0.5133 0.0568 	0.0000 	0.2012 	0.0000 ;%0.6971 0.0000 	0.0046 	0.1976 	0.0017 ;
% 0.6074 0.0306 0.0214 	0.1361 	0.0000 ;%0.6808 0.0000 	0.0134 	0.1714 	0.0104 ;
% 0.5126 0.0574 0.0079 	0.2188 	0.0008 ;%0.6591 0.0000 	0.0038 	0.2205 	0.0042 ;
% 0.6591 0.0000 0.0160 	0.1655 	0.0162 ;%0.6012 0.0000 	0.0089 	0.1724 	0.0146 ;
% 0.5154 0.0466 0.0087 	0.2540 	0.0010 ;%0.6330 0.0092 	0.0298 	0.1231 	0.0041 ;
% 0.5521 0.0000 0.0000 	0.2525 	0.0020 ;%0.5333 0.0080 	0.0282 	0.1571 	0.0110 ;
% 0.5061 0.0231 0.0063 	0.3190 	0.0019 ;%0.4901 0.0271 	0.0113 	0.3292 	0.0035 ;
% 0.5461 0.0000 0.0208 	0.2302 	0.0432 ;%0.3736 0.0000 	0.0000 	0.0930 	0.0575 ;
% 0.3194 0.0000 0.0047 	0.2914 	0.0014 ;%0.3957 0.0222 	0.0037 	0.4161 	0.0007 ;
% 0.3578 0.0000 0.0078 	0.4655 	0.0034 ;%0.3293 0.0138 	0.0068 	0.4931 	0.0048 ;
% 0.2542 0.0000 0.0131 	0.4510 	0.0000 ;%0.1979 0.0000 	0.0144 	0.2953 	0.0313 ;
% 0.2915 0.0000 0.0121 	0.4125 	0.0254 ;%0.2014 0.0000 	0.0148 	0.2868 	0.0359 ;
% 0.3434 0.0000 0.0449 	0.3922 	0.0000 ;%0.3693 0.0000 	0.0424 	0.3774 	0.0141 ;
% 0.4502 0.0000 0.0312 	0.3061 	0.0634 ;%0.3628 0.0000 	0.0234 	0.4743 	0.0357 ;
% 0.2625 0.0000 0.0111 	0.6103 	0.0116 ;%0.3359 0.0000 	0.0351 	0.2539 	0.0938 ;
% 0.2574 0.0122 0.0227 	0.4742 	0.0571 ;%0.0372 0.0000 	0.0301 	0.2992 	0.0604 ;
% 0.1671 0.0000 0.0187 	0.7021 	0.0177 ;%0.1241 0.0000 	0.0524 	0.5985 	0.0000 ;
% 0.2228 0.0000 0.0319 	0.5546 	0.0424 ;%0.1798 0.0000 	0.0319 	0.4400 	0.0634 ;
% 0.3039 0.0000 0.0349 	0.3935 	0.0899 ;%0.0461 0.0000 	0.0319 	0.3245 	0.0756 ;
% 0.2964 0.0000 0.0293 	0.4282 	0.0883 ;%0.2461 0.0000 	0.0358 	0.4024 	0.0810 ;
% 0.2879 0.0000 0.0458 	0.3418 	0.1110 ;%0.1846 0.0000 	0.0496 	0.4412 	0.0746 ;
% 0.1711 0.0000 0.0000 	0.5846 	0.1413 ;%0.2135 0.0000 	0.0513 	0.5134 	0.0875 ;
% 0.2170 0.0000 0.0640 	0.4475 	0.1283 ];     %铅钡玻璃
[n,m] = size(LZC);   %判断正向化
Judge = input('是否需要经过正向化处理1or0：');
 if Judge == 1
    Position = input('处理列数：');
    Type = input('请输入处理的指标类型 1:极小 2:中间 3:区间）：'); 
    for i = 1 : size(Position,2)  
        LZC(:,Position(i)) = Pos(LZC(:,Position(i)),Type(i),Position(i));
    end
end
Z = LZC ./ repmat(sum(LZC.*LZC) .^ 0.5, n, 1); %标准化
w=[3.547,2.696,2.197,1.731,1.505,1.206,0.843,0.94,1.038];  %输入权重
LZC
Z=LZC*w';    %加入权重计算
disp(Z);
D_P = sum((Z - repmat(max(Z),n,1)) .^ 2 ,2) .^ 0.5;   % D+ 与最大值的距离向量
D_N = sum((Z - repmat(min(Z),n,1)) .^ 2 ,2) .^ 0.5;   % D- 与最小值的距离向量
S = D_N ./ (D_P+D_N);    % 未归一化的得分
disp('Last point：')
stand_S = S / sum(S);
[sorted_S,index] = sort(stand_S ,'descend')